% Sets

\newcommand{\union}{\cup}
\newcommand{\intersection}{\cap}
\newcommand{\Union}{\bigcup}
\newcommand{\Intersection}{\bigcap}
\newcommand{\set}[1]{\mathcal #1}
\newcommand{\setcomplement}[1]{#1^{\mathrm{c}}}
\newcommand{\eucledian}{\mathbb E}
\newcommand{\reals}{\mathbb R}
\newcommand{\real}{\mathbb R}
\newcommand{\pos}{\mathbb R_{++}}
\newcommand{\nonneg}{\mathbb R_{+}}
\newcommand{\ball}[1][r]{\set B_{#1}}
\newcommand{\nat}{{\mbox{\bf N}}}
\newcommand{\integers}{\mathbb Z}
\newcommand{\binary}{\mathbb I}
\newcommand{\quaternion}{\mathbb Q}
\newcommand{\symm}{\mathbb S}  % symmetric matrices
\newcommand{\psd}{\mathbb S_{+}}
\newcommand{\pd}{\mathbb S_{++}}
\newcommand{\Co}{\mathrm{co}}
\newcommand{\dom}{\mathrm{dom}}
\newcommand{\epi}{\mathrm{epi}}
% \newcommand{\hypo}{\mathrm{hypo}}
\newcommand{\interior}[1]{\mathrm{int}(#1)}
\newcommand{\compl}[1]{#1^\mathrm{c}}
\newcommand{\boundary}[1]{\mathrm{bdry}\left(#1\right)}
\newcommand{\relint}{\mathrm{relint}}
\newcommand{\coni}[1]{\mathrm{coni}(#1)}
\newcommand{\bdry}{\partial}
\newcommand{\image}[1]{\mathrm{im}(#1)}
\newcommand{\domain}[1]{\mathrm{dom}(#1)}
\newcommand{\setHtwo}{\set{H}_2}
\newcommand{\setLinfty}{\set{L}_\infty}
\newcommand{\Ellipsoid}[1]{\mathcal E_{#1}}
\newcommand{\sequence}[3][k]{\{#2_{#1}\}_{#1=1}^{#3}}
\newcommand{\minkowplus}{\oplus}
\newcommand{\powerset}[1]{\mathscr{P}(#1)}
\newcommand{\zeroset}{\{0\}}

% Algorithms

\newcommand{\algvar}[1]{\text{\IfSubStr{#1}{_}{%
    \StrSubstitute{#1}{_}{\textunderscore}}{#1}}}
\newcommand{\true}{\algvar{true}\xspace}
\newcommand{\false}{\algvar{false}\xspace}

% Analysis

\newcommand{\Lone}[1]{\|#1\|_1}
\newcommand{\Ltwo}[1]{\|#1\|_2}
\newcommand{\FLinf}[2]{\|#1\|_{#2}}

% Numerical analysis

\renewcommand{\O}[1]{\mathcal O(#1)}

% Calculus

\newcommand{\grad}{\nabla}
\newcommand{\diff}[2]{\nabla_{#1}#2}

% Convex analysis

\newcommand{\subdiff}[1][none]{%
  \ifthenelse{\equal{#1}{none}}{%
    \partial%
  }{%
    \partial_{#1}%
  }%
}
\newcommand{\normalcone}[2]{\set{N}_{#1}(#2)}
\DeclareMathOperator{\conehull}{cone}
\DeclareMathOperator{\convhull}{conv}
\DeclareMathOperator{\extreme}{ext}
\newcommand{\indicator}[1]{\delta_{#1}}
\newcommand{\support}[1]{\delta^*_{#1}}

% Functions

\newcommand{\heaviside}{\sigma}

% Linear Algebra

\newcommand{\nul}{\mathrm{null}}
\newcommand{\rank}{\mathrm{rank}}
\DeclareMathOperator{\range}{range}
\newcommand{\diag}[2][short]{\mathrm{diag}\ifthenelse{\equal{#1}{short}}{(#2)}{\left(#2\right)}}
\DeclareMathOperator{\spec}{spec}
\newcommand{\rpinv}{\dagger}
\newcommand{\lpinv}{\ddagger}
\newcommand{\blkdiag}[1]{\mathrm{blkdiag}(#1)}
\DeclareMathOperator{\trace}{trace}
\newcommand{\svmax}[1]{\bar\sigma(#1)}

% Generic math

\newcommand{\C}[1]{\mathcal C^{#1}}
\newcommand{\inv}{^{-1}}
\newcommand{\invT}{^{-\transp}}
\newcommand{\sign}{\mathrm{sgn}}
\newcommand{\norm}[2]{\|#1\|_{#2}}
\newcommand{\vertiii}[1]{{\left\vert\kern-0.25ex\left\vert\kern-0.25ex\left\vert #1 
        \right\vert\kern-0.25ex\right\vert\kern-0.25ex\right\vert}}
\newcommand{\inorm}[2]{\vertiii{#1}_{#2}}
\newcommand{\seq}[1]{\{#1\}}
\newcommand{\sgn}{\mbox{\textrm{sgn}}}
\newcommand{\Proj}[1]{\mathop{\text{Proj}_{#1}}}
\newcommand{\Pre}{\mathop\text{Pre}}
\newcommand{\PP}{$\mathcal{P}$\xspace}
\newcommand{\NP}{$\mathcal{NP}$\xspace}
\newcommand{\NPhard}{$\mathcal{NP}$-hard\xspace}
\newcommand{\NPcomplete}{$\mathcal{NP}$-complete\xspace}
\newcommand{\transp}{{\scriptscriptstyle\mathsf{T}}}
\newcommand{\T}{^\transp}
\newcommand{\innerproduct}[2]{\langle#1,#2\rangle}
\newcommand{\dd}{\mathrm{d}}
\newcommand{\dt}{\dd t}
\newcommand{\fromabove}{\downarrow}
\newcommand{\frombelow}{\uparrow}
\newcommand{\fun}[2][1]{%
  #2(%
  \foreach \index in {1, ..., #1} {%
    \ifthenelse{\equal{\index}{#1}}{%
      \cdot%
    }{%
      \cdot,%
    }%
  })}
\newcommand{\define}[1]{\textit{#1}}%
\newcommand{\definedas}[1][tri]{%
  \ifthenelse{\equal{#1}{tri}}{\triangleq}{\coloneqq}}
\newcommand{\inlineint}{\textstyle\int}
\newcommand{\inlinesum}{\textstyle\sum}
\newcommand{\evalat}[2]{\left.#1\right|_{#2}}
\newcommand{\epsmach}{\epsilon_{mach}}
\renewcommand{\implies}{\Rightarrow}
\renewcommand{\iff}{\Leftrightarrow}
\newcommand{\mleq}{\preceq}
\newcommand{\mgeq}{\succeq}
\newcommand{\mle}{\prec}
\newcommand{\mgr}{\succ}
\DeclareMathOperator*{\exptx}{exp}
\renewcommand{\exp}[2][exponent]{\ifthenelse{\equal{#1}{exponent}}{e^{#2}}{\exptx\left(#2\right)}}
\DeclareMathOperator*{\expsf}{\mathsf{exp}}
\newcommand{\expm}[2][exponent]{\ifthenelse{\equal{#1}{exponent}}{\mathsf{e}^{#2}}{\expsf\left(#2\right)}}
\newcommand{\ttilde}[1]{\tilde{\raisebox{0pt}[0.85\height]{%
      $\tilde{#1}$}}}
\newcommand{\tttilde}[1]{\tilde{\raisebox{0pt}[0.88\height]{%
      $\tilde{\raisebox{0pt}[0.85\height]{%
          $\tilde{#1}$}}$}}}
\newcommand{\overlline}[1]{\overline{\overline{#1}}}
\newcommand{\bbar}[1]{\bar{\bar{#1}}}
\newcommand{\prefix}[2][]{{}^{#1}_{#2}}

\makeatletter
\DeclareFontFamily{U}{tipa}{}
\DeclareFontShape{U}{tipa}{m}{n}{<->tipa10}{}
\newcommand{\arc@char}{{\usefont{U}{tipa}{m}{n}\symbol{62}}}%
\renewcommand{\arc}[1]{\mathpalette\arc@arc{#1}}
\newcommand{\arc@arc}[2]{%
  \sbox0{$\m@th#1#2$}%
  \vbox{
    \hbox{\resizebox{\wd0}{\height}{\arc@char}}
    \nointerlineskip
    \box0
  }%
}
\makeatother

% Geometry

\newcommand{\fr}[1]{\mathcal{F}_{\mathcal{#1}}}

% Measure theory

\newcommand{\alev}[1]{\textnormal{a.e. }#1}
\newcommand{\ev}[3][c]{%
  \ifthenelse{\equal{#1}{c}}{%
    \ifthenelse{\equal{#2}{}}{\forall[0,#3]}{\forall[#2,#3]}%
  }{%
    \ifthenelse{\equal{#1}{o}}{%
      \ifthenelse{\equal{#2}{}}{\forall(0,#3)}{\forall(#2,#3)}%
    }{%
      \ifthenelse{\equal{#1}{oc}}{%
        \ifthenelse{\equal{#2}{}}{\forall(0,#3]}{\forall(#2,#3]}%
      }{%
        \ifthenelse{\equal{#2}{}}{\forall[0,#3)}{\forall[#2,#3)}%
      }%
    }%
  }%
}

% Optimization

\DeclareMathOperator*{\argmax}{argmax}
\DeclareMathOperator*{\argmin}{argmin}
\DeclareMathOperator*{\minimize}{\mathrm{minimize}}
\DeclareMathOperator*{\maximize}{\mathrm{maximize}}
\DeclareMathOperator*{\find}{\mathrm{find}}

\def\opticmd{\min}
\newenvironment{optienvc}{\begin{align}}{\end{align}}
\newenvironment{optienvl}{\begin{flalign}}{\end{flalign}}

\newcommand{\optimal}[1]{#1^*}
\newcommand{\sprocedure}{$\mathcal S$-procedure\xspace}

\newcounter{l}
\newcounter{j}
\newcounter{k}

\makeatletter
\newenvironment{taggedsubequations}[1]
{%
  % \end{subequations} will advance `equation`
  \addtocounter{equation}{-1}%
  \begin{subequations}%
    % set the current label
    \def\@currentlabel{#1}%
    % redefine \theequation
    \renewcommand{\theequation}{#1.\alph{equation}}%
  }
  {\end{subequations}}
\makeatother %not \makeatletter

\newcommand{\lloptimization}[7][center]{
  \setsepchar{\#}%
  \readlist\mylist{#6}
  \ifthenelse{\equal{#7}{}}{\begin{subequations}}{\begin{taggedsubequations}{#7}}
    \ifthenelse{\equal{#2}{}}{}{\label{eq:#2}}
    \ifthenelse{\equal{#1}{left}}{
      \begin{flalign}
        \ifthenelse{\equal{#2}{}}{}{\label{eq:#2_a}}
        \ifthenelse{\equal{#3}{}}{}{#3 = }
        &\opticmd_{\ifthenelse{\equal{#4}{}}{}{#4}}~ #5~\mathrm{s.t.}\hspace{-1mm} &&\\
        \forloop{k}{0}{\arabic{k} < \listlen\mylist[]}{
          \setcounter{j}{\value{k}+1}
          \setcounter{l}{\value{k}+2}
          \ifthenelse{\equal{#2}{}}{}{\label{eq:#2_\alph{l}}}
          \ifthenelse{\equal{\arabic{j}}{\listlen\mylist[]}}{%
            &\mylist[\arabic{j}]%
          }{%
            &\mylist[\arabic{j}] &&\\%
          }%
        }
      \end{flalign}
    }{\ifthenelse{\equal{#1}{center}}{
      \begin{align}
        \ifthenelse{\equal{#2}{}}{}{\label{eq:#2_a}}
        \ifthenelse{\equal{#3}{}}{}{#3 = }
        &\opticmd_{\ifthenelse{\equal{#4}{}}{}{#4}}~ #5~\mathrm{s.t.}\hspace{-1mm} &&\\
        \forloop{k}{0}{\arabic{k} < \listlen\mylist[]}{
          \setcounter{j}{\value{k}+1}
          \setcounter{l}{\value{k}+2}
          \ifthenelse{\equal{#2}{}}{}{\label{eq:#2_\alph{l}}}
          \ifthenelse{\equal{\arabic{j}}{\listlen\mylist[]}}{%
            &\mylist[\arabic{j}]%
          }{%
            &\mylist[\arabic{j}]\\%
          }%
        }
      \end{align}}{\ifthenelse{\equal{#1}{left*}}{
      \begin{flalign*}
        \ifthenelse{\equal{#3}{}}{}{#3 = }
        &\opticmd_{\ifthenelse{\equal{#4}{}}{}{#4}}~ #5~\mathrm{s.t.}\hspace{-1mm} &&\\
        \forloop{k}{0}{\arabic{k} < \listlen\mylist[]}{
          \setcounter{j}{\value{k}+1}
          \setcounter{l}{\value{k}+2}
          \ifthenelse{\equal{\arabic{j}}{\listlen\mylist[]}}{%
            &\mylist[\arabic{j}]%
          }{%
            &\mylist[\arabic{j}] &&\\%
          }%
        }
      \end{flalign*}
    }{\begin{align*}
        \ifthenelse{\equal{#3}{}}{}{#3 = }
        &\opticmd_{\ifthenelse{\equal{#4}{}}{}{#4}}~ #5~\mathrm{s.t.}\hspace{-1mm} &&\\
        \forloop{k}{0}{\arabic{k} < \listlen\mylist[]}{
          \setcounter{j}{\value{k}+1}
          \setcounter{l}{\value{k}+2}
          \ifthenelse{\equal{\arabic{j}}{\listlen\mylist[]}}{%
            &\mylist[\arabic{j}]%
          }{%
            &\mylist[\arabic{j}]\\%
          }%
        }
      \end{align*}}}
    }
  \ifthenelse{\equal{#7}{}}{\end{subequations}}{\end{taggedsubequations}}
}

\newcommand{\llpoptimization}[8][left]{
  \begin{problem}\ifthenelse{\equal{#2}{NoNe}}{}{\textbf{#2.}}%
    \ifthenelse{\equal{#3}{}}{}{\label{problem:#3}}%
    \lloptimization[#1]{#3}{#4}{#5}{#6}{#7}{#8}%
  \end{problem}%
}

\NewEnviron{optimization}[6]{\lloptimization[#1]{#2}{#3}{#4}{#5}{\BODY}{#6}}
\NewEnviron{foptimization}[7][NoNe]{%
  \begin{mdframed}[default,linewidth=1pt]%
    \llpoptimization[#2]{#1}{#3}{#4}{#5}{#6}{\BODY}{#7}%
  \end{mdframed}%
}
\NewEnviron{poptimization}[7][NoNe]{%
  \llpoptimization[#2]{#1}{#3}{#4}{#5}{#6}{\BODY}{#7}%
}

% Editing

\definecolor{darkolivegreen}{rgb}{0.33, 0.6, 0.18}
\definecolor{green}{rgb}{0, 0.5, 0}
\definecolor{orange}{rgb}{1, 0.4, 0}
\definecolor{darkgray}{rgb}{0.2, 0.2, 0.2}

\newcommand{\seecode}{\textit{For code, see Appendix~\ref{sec:code}}.}
\newcommand{\postmeeting}[2][show]{%
  \ifthenelse{\equal{#1}{show}}{%
    {\color{orange} #2}%
  }{}%
}
\newcommand{\idea}[2][show]{%
  \ifthenelse{\equal{#1}{show}}{%
    {\color{orange} #2}%
  }{}%
}
\newcommand{\todo}[2][show]{%
  \ifthenelse{\equal{#1}{show}}{%
    {\color{blue}%
      \ifthenelse{\equal{#2}{}}{TODO}{(TODO: #2)}}%
  }{}%
}
\newcommand{\question}[2][show]{%
  \ifthenelse{\equal{#1}{show}}{%
    {\color{darkolivegreen} (Q: #2)}%
  }{}%
}
\newcommand{\fixme}[2][show]{%
  \ifthenelse{\equal{#1}{show}}{%
    {\color{red} (FIXME: #2)}%
  }{}%
}
\newcommand{\mycomment}[2][show]{%
  \ifthenelse{\equal{#1}{show}}{%
    {\color{red} (C: #2)}%
  }{}%
}
\newcommand{\subfigref}[1]{(\protect\subref{#1})}

% Miscellaneous

\newcommand{\Behcet}{Beh\c{c}et\xspace}
\newcommand{\Acikmese}{A\c{c}{\i}kme\c{s}e\xspace}
\newcommand*\samethanks[1][\value{footnote}]{\footnotemark[#1]}
\makeatletter
\@ifclassloaded{beamer}{}{\newcommand{\alert}[1]{\textbf{#1}}}
\makeatother
\newcommand{\lcvx}{LCvx\xspace}
\newcommand{\emphasize}[1]{\textit{#1}}
\newcommand{\scvx}{SCvx\xspace}
\newcommand\dangersign[1][2ex]{%
  \renewcommand\stacktype{L}%
  \scaleto{\stackon[1.3pt]{\color{red}$\triangle$}{\tiny !}}{#1}%
}
\newcommand{\marginwarning}[1]{\marginnote{\footnotesize\dangersign{\color{red}#1}}}
\newcommand{\margindate}[1]{\marginnote{\footnotesize\color{red}\texttt{#1}}}
\newcommand{\textsub}[1]{_{\mathrm{#1}}}
\newcommand{\sref}[1]{Section~\ref{#1}}
\newcommand{\figref}[1]{Figure~\ref{#1}}
\newcommand{\probref}[1]{Problem~\ref{#1}}
\newcommand{\tabref}[1]{Table~\ref{#1}}
\newcommand{\secref}[1]{Section~\ref{#1}}
\newcommand{\easy}{{\color{olive}[easy]}\xspace}
\newcommand{\moderate}{{\color{orange}[moderate]}\xspace}
\newcommand{\hard}{{\color{red}[hard]}\xspace}
\newcommand{\stoppedhere}{{\color{red}\bfseries STOPPED~HERE}\xspace}
\renewcommand{\algref}[3]{\ifthenelse{\equal{#2}{}}{Algorithm~\ref{alg:#1}\xspace}%
  {\ifthenelse{\equal{#3}{}}{line~\ref{alg:#1:line:#2} %
      of Algorithm~\ref{alg:#1}\xspace}{lines~%
      \ref{alg:#1:line:#2}-\ref{alg:#1:line:#3} %
      of Algorithm~\ref{alg:#1}\xspace}}}
\newcommand{\defintext}[1]{\textbf{#1}}
